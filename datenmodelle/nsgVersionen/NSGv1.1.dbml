// NSG-Datenmodell v1.1 (dbdiagram-ready)
// Änderungen ggü. v1.0: neue Dokumenttypen, neue Zonentypen, zusätzliche Aktivitäten,
// Felder für Abgrenzung/Auslegung, Anhang: Maßstab, optionaler Katasterbezug.

Enum dokument_typ_enum {
  verordnung
  aenderungsverordnung
  ergaenzung
  befahrensverordnung
  polizeiverordnung
  berichtigung
  sonstige_verordnung
}

Enum dokument_status_enum {
  in_kraft
  aufgehoben
  unbekannt
}

Enum ausnahme_art_enum {
  genehmigung
  befreiung
  landwirtschaft
  forstwirtschaft
  jagd
  fischerei
  unterhaltung_infrastruktur
  telekommunikation
  energieversorgung
  verkehrssicherung_gefahrenabwehr
  informationstafeln_besucherlenkung
  invasive_arten_neobiota
  wissenschaft_pflege_entwicklung
  sonstiges
}

Enum zone_typ_enum {
  gesamtgebiet
  uferzone
  altarm
  buhnenfeld
  gewasserflaeche
  schutzstreifen
  waldabteilung
  wiese_acker
  weg_trasse
  ruhezone
  sonstiges
}

Enum bedingung_typ_enum {
  jahreszeit
  datumspanne
  tageszeit
  wochentag
  wetter
  abstand_m
  menge_limit
  wegepflicht
  zonenbezug
  geschwindigkeit
  artenschutz_schutzzeit
  sonstiges
}

Enum jahreszeit_enum {
  fruehling
  sommer
  herbst
  winter
}

Enum tageszeit_enum {
  tag
  nacht
  daemmerung
}

Enum wetterbedingung_enum {
  schnee
  eis
  regen
  naesse
  nebel
  sonne
  trockenheit
  sturm
}

Enum ort_enum {
  gesamte_flaeche_des_gebietes
  oeffentlich_gewidmete_strassen_plaetze
  ausgewiesene_wege_plaetze
  unbefestigte_land_und_forstwirtschaftliche_wege
  pfade
  gewasserflaeche
  uferbereich
}

Enum erlaubnis_enum {
  erlaubt
  verboten
  nur_mit_behoerdlicher_erlaubnis_erlaubt
  nur_mit_grundbesitzererlaubnis_erlaubt
  nicht_empfohlen
}

Enum kategorie_enum {
  bergaktivitaeten
  reitaktivitaeten
  radsportaktivitaeten
  motorisierte_aktivitaeten
  laufaktivitaeten
  aufenthaltsaktivitaeten
  generelles_verhalten
  luftaktivitaeten
  schneeaktivitaeten
  urbane_aktivitaeten
  wasseraktivitaeten
  betretungsverhalten
  nutzungs_eingriffs_handlungen
}

Enum aktivitaet_enum {
  // Freizeit/Verhalten (bestehend)
  klettern
  base_jumping
  reiten
  bespannte_fahrzeuge
  radfahren
  kraftfahrzeug
  camping_fahrzeug_anhaenger
  lagern_biwakieren
  feuer
  zelten
  pflanzen_sammeln
  pilze_sammeln
  mineralien_fossilien_sammeln
  baeume_faellen_oder_verletzen
  fotografieren_filmen
  laerm_tonband_abspielgeraete
  toilettengang
  abfall_entsorgen
  hunde
  hunde_ohne_leine
  ballonfahren
  drohnen_flugmodelle
  panoramafluege
  paraglider
  segelflieger
  ultraleichtflieger
  rodeln_schlitten
  schneeschuhwandern
  ski_und_snowboardfahren
  skilanglauf
  skitouren
  angeln
  baden
  baden_von_tieren
  tauchen
  nutzung_von_schwimmhilfe
  wasserfahrzeuge_ohne_motor
  wasserfahrzeuge_motorisiert
  betreten_des_gebietes
  betreten_abseits_der_wege
  eisklettern
  tiere_fuettern
  rauchen
  luftsport_starten_landen
  wintersport
  wassersport

  // NSG-spezifische Eingriffe/Anlagen/Verhalten (erweitert)
  bauliche_anlagen_errichten_oder_erweitern
  leitungen_verlegen_ueber_unter_erde
  einfriedungen_errichten_oder_erweitern
  materiallagerplaetze_schrottplaetze_anlegen
  abfall_ablegen_verunreinigen
  bodengestalt_aendern_abgraben_auffuellen_sprengen_bohren
  gewaesser_herstellen_beseitigen_umgestalten_ufer_aendern
  aufforstung_erstmalig
  waldroden
  umwandlung_dauergruenland
  duenger_ausbringen
  pflanzenbehandlungsmittel_chemische_mittel_verwenden
  nichtheimische_arten_einbringen
  tiernachstellung_fang_toetung_brutstaetten_stoeren
  jagd_ausuebung
  fischereiliche_nutzung_fischbesatz
  reiten_ausserhalb_ausgewiesener_wege
  fahren_parken_ausserhalb_oefentlich_gewidmeter_wege
  modellflug_drohnen_betreiben
  modellfahrzeuge_betreiben
  modellschiffe_betreiben
  feuer_anzuenden_unterhalten_grillen
  anlegestellen_anglerstege_errichten
  segeln_surfen_befahren_ohne_motor
  tauchen_mit_ausruestung
  bild_oder_schrifttafeln_anbringen
  intensive_weidewirtschaft
  wildacker_anlegen_oder_unterhalten
  wildfuetterungsstellen_anlegen_oder_unterhalten
  strassen_und_wege_neu_oder_ausbauen
  weihnachtsbaumkultur_anlegen
  baumschulkulturen_anlegen
  sonderkulturen_anlegen
  eissport_auf_gewaessern
  geocaching
  massensportveranstaltung_durchfuehren
}

Table schutzgebiet {
  id int [pk, increment]
  uuid uuid [unique, not null]
  kennung text
  name text
  kreis text
  gemeinden_text text
  flaeche_ha decimal(10,2)
  wfs_url text
  gml_id text
  created_at timestamp
  updated_at timestamp

  indexes {
    (uuid) [unique]
  }
}

Table behoerde {
  id int [pk, increment]
  name text
  ebene text
  ort text
}

Table dokument {
  id int [pk, increment]
  schutzgebiet_id int [not null, ref: > schutzgebiet.id]
  typ dokument_typ_enum [not null]
  status dokument_status_enum
  titel text
  datum date
  gueltig_ab date
  gueltig_bis date
  aktenzeichen text
  amtsblatt text
  rechtsgrundlage text
  abgrenzung_text text
  auslegung_hinweis text
  pdf_quelle text
  seiten_anzahl int
  ersetzt_dokument_id int [ref: > dokument.id]
  ist_fehlanzeige boolean
  created_at timestamp
  updated_at timestamp
}

Table dokument_behoerde {
  dokument_id int [ref: > dokument.id]
  behoerde_id int [ref: > behoerde.id]
  rolle text

  indexes {
    (dokument_id, behoerde_id, rolle) [pk]
  }
}

Table paragraf {
  id int [pk, increment]
  dokument_id int [not null, ref: > dokument.id]
  nummer text
  rubrum text
  text text
  sort_index int
  created_at timestamp
  updated_at timestamp

  indexes {
    (dokument_id, nummer) [unique]
  }
}

Table anhang {
  id int [pk, increment]
  dokument_id int [not null, ref: > dokument.id]
  bezeichnung text
  seiten_hinweis text
  massstab text
  beschreibung text
}

Table katasterbezug {
  id int [pk, increment]
  dokument_id int [not null, ref: > dokument.id]
  gemarkung text
  flur text
  flurstueck text
  teilweise boolean
  ausgenommen boolean
  kommentar text
}

Table zone {
  id int [pk, increment]
  schutzgebiet_id int [not null, ref: > schutzgebiet.id]
  name text
  typ zone_typ_enum
  beschreibung text
  geometrie_ref text
  created_at timestamp
  updated_at timestamp

  indexes {
    (schutzgebiet_id, name) [unique]
  }
}

Table aktivitaetskategorie {
  id int [pk, increment]
  code int [not null, unique]
  kategorie kategorie_enum
}

Table aktivitaet {
  id int [pk, increment]
  code int [not null, unique]
  kategorie_id int [ref: > aktivitaetskategorie.id]
  aktivitaet aktivitaet_enum
}

Table aktivitaetsort {
  id int [pk, increment]
  code int [not null, unique]
  ort ort_enum
}

Table aktivitaetserlaubnis {
  id int [pk, increment]
  code int [not null, unique]
  erlaubnis erlaubnis_enum
}

Table icon {
  id int [pk, increment]
  name text [not null]
  datei text
}

Table user {
  id int [pk, increment]
  organisation text
  homepage text
  adresse text
  email text
}

Table regel {
  id int [pk, increment]
  schutzgebiet_id int [not null, ref: > schutzgebiet.id]
  aktivitaet_id int [not null, ref: > aktivitaet.id]
  ort_id int [not null, ref: > aktivitaetsort.id]
  erlaubnis_id int [not null, ref: > aktivitaetserlaubnis.id]
  zone_id int [ref: > zone.id]
  gueltig_ab date
  gueltig_bis date
  kommentar text
  user_id int [ref: > user.id]
  created_at timestamp
  updated_at timestamp

  jahreszeit jahreszeit_enum
  tageszeit tageszeit_enum
  wetterbedingung wetterbedingung_enum
  min_weg_breite decimal(5,2)
}

Table regel_icon {
  regel_id int [ref: > regel.id]
  icon_id int [ref: > icon.id]

  indexes {
    (regel_id, icon_id) [pk]
  }
}

Table regel_paragraf {
  regel_id int [ref: > regel.id]
  paragraf_id int [ref: > paragraf.id]
  satz text

  indexes {
    (regel_id, paragraf_id, satz) [pk]
  }
}

Table regel_bedingung {
  id int [pk, increment]
  regel_id int [not null, ref: > regel.id]
  typ bedingung_typ_enum [not null]
  jahreszeit jahreszeit_enum
  tageszeit tageszeit_enum
  wetter wetterbedingung_enum
  datum_von date
  datum_bis date
  zeit_von time
  zeit_bis time
  menge_limit int
  abstand_meter decimal(6,2)
  geschwindigkeit decimal(6,2)
  zone_id int [ref: > zone.id]
  details text
}

Table regel_ausnahme {
  id int [pk, increment]
  regel_id int [not null, ref: > regel.id]
  art ausnahme_art_enum [not null]
  behoerde_id int [ref: > behoerde.id]
  text text
}

Table sanktion {
  id int [pk, increment]
  paragraf_id int [not null, ref: > paragraf.id]
  gesetz_ref text
  text text
}

Table dokument_rechtsverweis {
  id int [pk, increment]
  dokument_id int [not null, ref: > dokument.id]
  zitat text
  bemerkung text
}

// Relationships (readability only)
// regel -> aktivitaet, aktivitaetsort, aktivitaetserlaubnis, schutzgebiet, zone, user
// regel -> regel_bedingung, regel_ausnahme, regel_paragraf
// dokument -> schutzgebiet, paragraf, anhang, katasterbezug, dokument_behoerde, dokument_rechtsverweis
// paragraf -> sanktion
// schutzgebiet -> zone
